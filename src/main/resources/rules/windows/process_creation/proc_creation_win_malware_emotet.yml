title: Emotet Process Creation
id: d02e8cf5-6099-48cf-9bfc-1eec2d0c7b18
status: stable
description: Detects all Emotet like process executions that are not covered by the more generic rules
author: Florian Roth
date: 2019/09/30
modified: 2021/11/29
tags:
    - attack.execution
    - attack.t1059.001
    - attack.defense_evasion
    - attack.t1027
references:
  - https://app.any.run/tasks/e13ab713-64cf-4b23-ad93-6dceaa5429ac/
  - https://app.any.run/tasks/81f3c28c-c686-425d-8a2b-a98198d244e1/
  - https://app.any.run/tasks/97f875e8-0e08-4328-815f-055e971ba754/
  - https://app.any.run/tasks/84fc9b4a-ea2b-47b1-8aa6-9014402dfb56/
logsource:
  category: process_creation
  product: windows
detection:
  selection:
    CommandLine|contains:
      - ' -e* PAA'
      - 'JABlAG4AdgA6AHUAcwBlAHIAcAByAG8AZgBpAGwAZQ'  # $env:userprofile
      - 'QAZQBuAHYAOgB1AHMAZQByAHAAcgBvAGYAaQBsAGUA'  # $env:userprofile
      - 'kAGUAbgB2ADoAdQBzAGUAcgBwAHIAbwBmAGkAbABlA'  # $env:userprofile
      - 'IgAoACcAKgAnACkAOwAkA'  # "('*');$
      - 'IAKAAnACoAJwApADsAJA'  # "('*');$
      - 'iACgAJwAqACcAKQA7ACQA'  # "('*');$
      - 'JABGAGwAeAByAGgAYwBmAGQ'
      - 'PQAkAGUAbgB2ADoAdABlAG0AcAArACgA'  # =$env:temp+(
      - '0AJABlAG4AdgA6AHQAZQBtAHAAKwAoA'  # =$env:temp+(
      - '9ACQAZQBuAHYAOgB0AGUAbQBwACsAKA'  # =$env:temp+(
  condition: selection
fields:
  - CommandLine
  - ParentCommandLine
falsepositives:
  - Unlikely
level: high

